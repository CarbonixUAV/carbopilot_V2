# hw definition file for processing by chibios_pins.py

# MCU class and specific type
MCU STM32L496 STM32L496xx

include ../CarbonixCommon/cpn.inc

# bootloader starts firmware at 36k + 4k (STORAGE_FLASH)
undef FLASH_RESERVE_START_KB
FLASH_RESERVE_START_KB 40

# store parameters in pages 18 and 19
undef STORAGE_FLASH_PAGE
STORAGE_FLASH_PAGE 18
undef HAL_STORAGE_SIZE
define HAL_STORAGE_SIZE 800

# board ID for firmware load
undef APJ_BOARD_ID
APJ_BOARD_ID 1053

# assume the 256k flash part
undef FLASH_SIZE_KB
FLASH_SIZE_KB 256

PC6 TIM3_CH1 TIM3 PWM(3) GPIO(52) # LED

# USART3
undef PC10
undef PC11
PC4 USART3_TX USART3 SPEED_HIGH NODMA
PC5 USART3_RX USART3 SPEED_HIGH NODMA

# disable debugger support (disabled as conflicts with LED)
undef PA13
undef PA14

# LED, active low
undef PA15
PA13 LED OUTPUT HIGH GPIO(1)

# one I2C bus
undef I2C1
undef PB6
PB6 I2C4_SCL I2C4
undef PB7
PB7 I2C4_SDA I2C4

undef I2C_ORDER
I2C_ORDER I2C4

undef PA5
undef PA6
undef PB0
PA4 VSENSE1 ADC1 SCALE(1)
PA5 VSENSE2 ADC1 SCALE(1)
PA6 VSENSE3 ADC1 SCALE(1)

define HAL_PERIPH_ENABLE_MAG
define HAL_PERIPH_ENABLE_BARO
# enable ESC control
define HAL_WITH_ESC_TELEM 1

# enable GPS
define HAL_PERIPH_ENABLE_GPS
define HAL_PERIPH_GPS_PORT_DEFAULT 2

# default ADSB off by setting 0 baudrate
define HAL_PERIPH_ENABLE_ADSB
define HAL_PERIPH_ADSB_PORT_DEFAULT 3
define HAL_PERIPH_ADSB_BAUD_DEFAULT 57600

BARO MS56XX I2C:0:0x76
define AP_COMPASS_QMC5883P_ENABLED 1
COMPASS QMC5883P I2C:0:0x2C false ROTATION_YAW_180

undef HAL_PERIPH_ARM_MONITORING_ENABLE

define CAN_APP_NODE_NAME "org.ardupilot.CarbonixL496"
